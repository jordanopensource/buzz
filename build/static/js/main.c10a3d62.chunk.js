(this.webpackJsonpmultibuzzer=this.webpackJsonpmultibuzzer||[]).push([[0],{147:function(e,t){},151:function(e,t,a){},152:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(38),l=a.n(c),o=(a(99),a(12)),u=a(37),s=a(17),i=a(10),m=a(3),d=a.n(m),p=a(9),b=a(13),f=a(159),E=a(156),v=a(21),h=a.n(v),y=a(2);var O={name:"buzzer",minPlayers:2,maxPlayers:200,setup:function(){return{queue:{},locked:!1}},phases:{play:{start:!0,moves:{buzz:function(e,t,a){var n=Object(y.a)({},e.queue);n[a]||(n[a]={id:a,timestamp:(new Date).getTime()}),e.queue=n},resetBuzzer:function(e,t,a){var n=Object(y.a)({},e.queue);delete n[a],e.queue=n},resetBuzzers:function(e){e.queue={}},toggleLock:function(e){e.locked=!e.locked}},turn:{activePlayers:a(1).A.ALL}}}};h.a.defaults.headers["Content-Type"]="application/json",h.a.defaults.headers.Accept="application/json";var g=window.location.hostname,j=window.location.port,w=window.location.protocol,k=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).PORT||4001,z=w+"//"+g+(j?":"+j:""),N=("".concat(w,"//").concat(g,":").concat(k),z),D=z;function x(e){return I.apply(this,arguments)}function I(){return(I=Object(p.a)(d.a.mark((function e(t){var a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.toUpperCase(),e.prev=1,e.next=4,h.a.get("".concat(N,"/games/").concat(O.name,"/").concat(a));case 4:return n=e.sent,e.abrupt("return",n);case 8:if(e.prev=8,e.t0=e.catch(1),!e.t0.response){e.next=14;break}return e.abrupt("return",e.t0.response);case 14:return e.abrupt("return",{status:500});case 15:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}function C(){return S.apply(this,arguments)}function S(){return(S=Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=h.a.post("".concat(N,"/games/").concat(O.name,"/create"),{numPlayers:200}),e.abrupt("return",t);case 5:if(e.prev=5,e.t0=e.catch(0),!e.t0.response){e.next=11;break}return e.abrupt("return",e.t0.response);case 11:return e.abrupt("return",{status:500});case 12:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function B(e,t,a){return q.apply(this,arguments)}function q(){return(q=Object(p.a)(d.a.mark((function e(t,a,n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=h.a.post("".concat(N,"/games/").concat(O.name,"/").concat(t,"/join"),{playerID:a,playerName:n}),e.abrupt("return",r);case 5:if(e.prev=5,e.t0=e.catch(0),!e.t0.response){e.next=11;break}return e.abrupt("return",e.t0.response);case 11:return e.abrupt("return",{status:500});case 12:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function A(e,t,a){return G.apply(this,arguments)}function G(){return(G=Object(p.a)(d.a.mark((function e(t,a,n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=h.a.post("".concat(N,"/games/").concat(O.name,"/").concat(t,"/leave"),{playerID:a,credentials:n}),e.abrupt("return",r);case 5:if(e.prev=5,e.t0=e.catch(0),!e.t0.response){e.next=11;break}return e.abrupt("return",e.t0.response);case 11:return e.abrupt("return",{status:500});case 12:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}var L,P=a(158);function T(e){var t=e.size,a=void 0===t?25:t;return r.a.createElement("svg",{width:a,height:a,viewBox:"0 0 95 95",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("circle",{cx:"20",cy:"20",r:"20",fill:"#F2994A"}),r.a.createElement("circle",{cx:"75",cy:"20",r:"20",fill:"#348DF5"}),r.a.createElement("circle",{cx:"20",cy:"75",r:"20",fill:"#348DF5"}),r.a.createElement("circle",{cx:"75",cy:"75",r:"20",fill:"#348DF5"}))}function R(e){var t=e.auth,a=void 0===t?{}:t,n=e.clearAuth,c=e.sound,l=void 0===c?null:c,o=e.setSound,u=Object(s.g)();function m(){return(m=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A(a.roomID,a.playerID,a.credentials);case 3:n(),u.push("/"),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("leave error",e.t0),n(),u.push("/");case 12:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}return r.a.createElement("header",null,r.a.createElement(P.a,null,r.a.createElement(P.a.Brand,null,r.a.createElement(T,null)," Multibuzzer"),r.a.createElement("div",{className:"nav-buttons"},Object(i.isNil)(l)?null:r.a.createElement("button",{className:"text-button",onClick:function(){return o()}},l?"Turn off sound":"Turn on sound"),n?r.a.createElement("button",{className:"text-button",onClick:function(){return function(){return m.apply(this,arguments)}()}},"Leave game"):null)))}function _(){return r.a.createElement("div",{id:"footer-simple"},"Built on"," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/wsun/multibuzzer"},"open source"))}function H(e){var t=e.mobileOnly,a=void 0!==t&&t;return r.a.createElement("footer",{className:a?"d-block d-md-none":null},r.a.createElement(E.a,null,r.a.createElement("div",null,"Built on"," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/wsun/multibuzzer"},"open source"))))}var J="emptyCode",U="roomCode",F="name",W="hostRoom",M="fullRoom",K="dupName",Y=(L={},Object(b.a)(L,J,"Please enter a room code"),Object(b.a)(L,U,"Unable to join room with this code"),Object(b.a)(L,F,"Please enter your player name"),Object(b.a)(L,K,"Player name already taken"),Object(b.a)(L,W,"Unable to create room, please try again"),Object(b.a)(L,M,"Room has reached capacity"),L);function V(e){var t=e.setAuth,a=Object(s.h)(),c=Object(i.get)(a,"state.roomID"),l=Object(s.g)(),u=Object(n.useState)(""),m=Object(o.a)(u,2),b=m[0],v=m[1],h=Object(n.useState)(c||""),y=Object(o.a)(h,2),O=y[0],g=y[1],j=Object(n.useState)(!0),w=Object(o.a)(j,2),k=w[0],z=w[1],N=Object(n.useState)(""),D=Object(o.a)(N,2),I=D[0],S=D[1],q=Object(n.useState)(!1),A=Object(o.a)(q,2),G=A[0],L=A[1];function P(e){return T.apply(this,arguments)}function T(){return(T=Object(p.a)(d.a.mark((function e(a){var n,r,c,o,u,s,m,p,f=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.length>1&&void 0!==f[1]&&f[1]||L(!0),e.prev=2,e.next=5,x(a);case 5:if(200===(n=e.sent).status){e.next=8;break}throw new Error(U);case 8:if(r=n.data,c=r.players.find((function(e){return e.name===b})),o=r.players.find((function(e){return!e.name})),!c||!c.connected){e.next=13;break}throw new Error(K);case 13:if(c||o){e.next=15;break}throw new Error(M);case 15:return u=Object(i.get)(c,"id",Object(i.get)(o,"id")),e.next=18,B(r.roomID,u,b);case 18:if(200===(s=e.sent).status){e.next=21;break}throw new Error(U);case 21:m=s.data,p={playerID:u,credentials:m.playerCredentials,roomID:r.roomID},t(p),L(!1),l.push("/".concat(r.roomID)),e.next=32;break;case 28:e.prev=28,e.t0=e.catch(2),L(!1),S(Y[e.t0.message]);case 32:case"end":return e.stop()}}),e,null,[[2,28]])})))).apply(this,arguments)}function V(){return(V=Object(p.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(!0),e.prev=1,e.next=4,C();case 4:if(200===(t=e.sent).status){e.next=7;break}throw new Error(W);case 7:return a=t.data.gameID,e.next=10,P(a,!0);case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),L(!1),S(Y[e.t0.message]);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function $(e){e.preventDefault(),k?0===O.trim().length?S(Y[J]):0===b.trim().length?S(Y[F]):6!==O.trim().length?S(Y[U]):P(O):0===b.trim().length?S(Y[F]):function(){V.apply(this,arguments)}()}var Q=k?r.a.createElement(f.a,{className:"lobby-form",onSubmit:function(e){return $(e)}},r.a.createElement("h3",null,"Join a game"),r.a.createElement(f.a.Group,{controlId:"room"},r.a.createElement(f.a.Label,null,"Room code"),r.a.createElement(f.a.Control,{value:O,autoComplete:"off",autoCorrect:"off",autoCapitalize:"characters",spellCheck:"false",onChange:function(e){S(""),g(e.target.value)}})),r.a.createElement(f.a.Group,{controlId:"name"},r.a.createElement(f.a.Label,null,"Your name"),r.a.createElement(f.a.Control,{value:b,onChange:function(e){S(""),v(e.target.value)}})),r.a.createElement("div",{className:"error-message"},I),r.a.createElement("button",{type:"submit",disabled:G},G?"Joining...":"Join"),r.a.createElement("div",{className:"switcher"},"Hosting a game?"," ",r.a.createElement("button",{className:"inline",onClick:function(){S(""),z(!1)}},"Create room"))):r.a.createElement(f.a,{className:"lobby-form",onSubmit:function(e){return $(e)}},r.a.createElement("h3",null,"Host a game"),r.a.createElement(f.a.Group,{controlId:"name"},r.a.createElement(f.a.Label,null,"Your name"),r.a.createElement(f.a.Control,{value:b,onChange:function(e){S(""),v(e.target.value)}})),r.a.createElement("div",{className:"error-message"},I),r.a.createElement("button",{type:"submit",disabled:G},G?"Creating...":"Host"),r.a.createElement("div",{className:"switcher"},"Joining a game?"," ",r.a.createElement("button",{className:"inline",onClick:function(){S(""),z(!0)}},"Enter room"))),X=r.a.createElement("div",{className:"touts"},r.a.createElement("div",null,r.a.createElement("h4",null,"Simple multiplayer buzzer system"),r.a.createElement("p",null,"Host a room and invite up to 200 people to join")),r.a.createElement("div",null,r.a.createElement("h4",null,"Join on any device"),r.a.createElement("p",null,"Use your computer, smartphone, or tablet to join and start buzzing")),r.a.createElement("div",null,r.a.createElement("h4",null,"Free to use"),r.a.createElement("p",null,"Perfect for online quiz bowl, trivia night, or a classroom activity")));return r.a.createElement("main",{id:"lobby"},r.a.createElement("section",{className:"primary d-none d-md-flex"},r.a.createElement("div",{id:"lobby-left"},r.a.createElement("div",null,r.a.createElement(R,null),r.a.createElement("section",{className:"container-half"},X)),r.a.createElement("section",{className:"container-half"},r.a.createElement(_,null))),r.a.createElement("div",{id:"lobby-right"},r.a.createElement("section",{className:"container-half"},Q))),r.a.createElement("section",{className:"primary d-block d-md-none"},r.a.createElement(R,null),r.a.createElement(E.a,{className:"container-mobile"},Q),r.a.createElement("div",{className:"divider"}),r.a.createElement(E.a,{className:"container-mobile"},X)),r.a.createElement(H,{mobileOnly:!0}))}var $=a(157),Q=a(91),X=a(42),Z=a(87),ee=a(58);function te(e){var t=Object(n.useState)(!1),a=Object(o.a)(t,2),c=a[0],l=a[1],u=Object(n.useState)(Object(i.some)(e.G.queue,(function(t){return t.id===e.playerID}))),s=Object(o.a)(u,2),m=s[0],d=s[1],p=Object(n.useState)(null),b=Object(o.a)(p,2),f=b[0],v=b[1],h=Object(n.useState)(!1),O=Object(o.a)(h,2),g=O[0],j=O[1],w=Object(n.useState)(!1),k=Object(o.a)(w,2),z=k[0],N=k[1],D=Object(n.useRef)(null),x=Object(n.useRef)(null),I=new Z.Howl({src:["".concat("","/shortBuzz.webm"),"".concat("","/shortBuzz.mp3")],volume:.5,rate:1.5}),C=function(){g&&!z&&(I.play(),N(!0))};Object(n.useEffect)((function(){console.log(e.G.queue,Date.now()),e.G.queue[e.playerID]||(f&&Date.now()-f<500?setTimeout((function(){var t=x.current;t&&!t[e.playerID]&&d(!1)}),500):d(!1)),Object(i.isEmpty)(e.G.queue)?N(!1):c&&C(),c||l(!0),x.current=e.G.queue}),[e.G.queue]);Object(n.useEffect)((function(){function e(e){32!==e.keyCode||e.repeat||(D.current.click(),e.preventDefault())}return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}),[]);var S=e.gameMetadata?e.gameMetadata.filter((function(e){return e.name})).map((function(e){return Object(y.a)({},e,{id:String(e.id)})})):[],B=Object(i.get)(Object(i.sortBy)(S,(function(e){return parseInt(e.id,10)})).filter((function(e){return e.connected})),"0")||null,q=Object(i.get)(B,"id")===e.playerID,A=Object(i.sortBy)(Object(i.values)(e.G.queue),["timestamp"]),G=A.map((function(e){var t=S.find((function(t){return t.id===e.id}));return t?Object(y.a)({},e,{name:t.name,connected:t.connected}):{}})).filter((function(e){return e.name})),L=Object(i.orderBy)(S.filter((function(e){return!Object(i.some)(A,(function(t){return t.id===e.id}))})),["connected","name"],["desc","asc"]);return r.a.createElement("div",null,r.a.createElement(R,{auth:e.headerData,clearAuth:function(){return e.headerData.setAuth({playerID:null,credentials:null,roomID:null})},sound:g,setSound:function(){return j(!g)}}),r.a.createElement(E.a,null,r.a.createElement("section",null,r.a.createElement("p",{id:"room-title"},"Room ",e.gameID),e.isConnected?null:r.a.createElement("p",{className:"warning"},"Disconnected - attempting to reconnect..."),r.a.createElement("div",{id:"buzzer"},r.a.createElement("button",{ref:D,disabled:m||e.G.locked,onClick:function(){m||e.G.locked||m||(C(),e.moves.buzz(e.playerID),d(!0),v(Date.now()))}},e.G.locked?"Locked":m?"Buzzed":"Buzz")),q?r.a.createElement("div",{className:"settings"},r.a.createElement("div",{className:"button-container"},r.a.createElement("button",{className:"text-button",onClick:function(){return e.moves.toggleLock()}},e.G.locked?"Unlock buzzers":"Lock buzzers")),r.a.createElement("div",{className:"button-container"},r.a.createElement("button",{disabled:Object(i.isEmpty)(e.G.queue),onClick:function(){return e.moves.resetBuzzers()}},"Reset all buzzers")),r.a.createElement("div",{className:"divider"})):null),r.a.createElement("div",{className:"queue"},r.a.createElement("p",null,"Players Buzzed"),r.a.createElement("ul",null,G.map((function(t,a){var n,c=t.id,l=t.name,o=t.timestamp,u=t.connected;return r.a.createElement("li",{key:c,className:q?"resettable":null},r.a.createElement("div",{className:"player-sign",onClick:function(){q&&e.moves.resetBuzzer(c)}},r.a.createElement("div",{className:"name ".concat(u?"":"dim")},l,u?"":r.a.createElement(ee.a,{className:"disconnected"})),a>0?r.a.createElement("div",{className:"mini"},(n=o-A[0].timestamp)>1e3?"+".concat(Object(i.round)(n/1e3,2)," s"):"+".concat(n," ms")):null))})))),r.a.createElement("div",{className:"queue"},r.a.createElement("p",null,"Other Players"),r.a.createElement("ul",null,L.map((function(e){var t=e.id,a=e.name,n=e.connected;return r.a.createElement("li",{key:t},r.a.createElement("div",{className:"name ".concat(n?"":"dim")},a,n?"":r.a.createElement(ee.a,{className:"disconnected"})))}))))))}function ae(e){var t=e.auth,a=e.setAuth,n=Object(s.i)().id,c=Object(Q.a)({game:O,board:te,multiplayer:Object(X.b)({server:D}),debug:!1,loading:function(){return r.a.createElement("div",null,r.a.createElement(R,{auth:t,clearAuth:function(){return a({playerID:null,credentials:null,roomID:null})}}),r.a.createElement(E.a,{className:"container-loading"},r.a.createElement($.a,{animation:"border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))))}});return r.a.createElement("main",{id:"game"},r.a.createElement("div",{className:"primary"},r.a.createElement(c,{gameID:n,playerID:String(t.playerID),credentials:t.credentials,headerData:Object(y.a)({},t,{setAuth:a})})))}a(151);var ne=function(){var e=Object(n.useState)({playerID:null,credentials:null,roomID:null}),t=Object(o.a)(e,2),a=t[0],c=t[1];return r.a.createElement("div",{className:"App"},r.a.createElement(u.a,null,r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/:id",render:function(e){var t=e.location,n=e.match,l=Object(i.get)(n,"params.id");return!l||a.roomID!==l||Object(i.isNil)(a.credentials)||Object(i.isNil)(a.playerID)?r.a.createElement(s.a,{to:{pathname:"/",state:{from:t,roomID:l}}}):r.a.createElement(ae,{auth:a,setAuth:c})}}),r.a.createElement(s.b,{path:"/"},r.a.createElement(V,{setAuth:c})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ne,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},94:function(e,t,a){e.exports=a(152)},99:function(e,t,a){}},[[94,1,2]]]);
//# sourceMappingURL=main.c10a3d62.chunk.js.map